[2024-10-08 14:28:56,438] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 14:28:56,460] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 14:28:56,460] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:28:56,460] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 14:28:56,460] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:28:56,472] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-07 00:00:00+00:00
[2024-10-08 14:28:56,474] {standard_task_runner.py:52} INFO - Started process 266 to run task
[2024-10-08 14:28:56,477] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'scheduled__2024-10-07T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmp6hl9lx_1', '--error-file', '/tmp/tmp6emtwqiy']
[2024-10-08 14:28:56,480] {standard_task_runner.py:77} INFO - Job 2: Subtask extract_user_purchase_data
[2024-10-08 14:28:56,520] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [running]> on host a4db7faca92e
[2024-10-08 14:28:56,575] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-07T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-07T00:00:00+00:00
[2024-10-08 14:28:56,576] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 14:28:56,576] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 14:28:56,580] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 14:28:57,286] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 14:28:57,296] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241007T000000, start_date=20241008T142856, end_date=20241008T142857
[2024-10-08 14:28:57,332] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 14:28:57,379] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 14:28:59,291] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:28:55.444300+00:00 [queued]>
[2024-10-08 14:28:59,313] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:28:55.444300+00:00 [queued]>
[2024-10-08 14:28:59,314] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:28:59,314] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 14:28:59,314] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:28:59,324] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 14:28:55.444300+00:00
[2024-10-08 14:28:59,326] {standard_task_runner.py:52} INFO - Started process 268 to run task
[2024-10-08 14:28:59,329] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T14:28:55.444300+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmp3d06m2fs', '--error-file', '/tmp/tmppkkslypd']
[2024-10-08 14:28:59,332] {standard_task_runner.py:77} INFO - Job 3: Subtask extract_user_purchase_data
[2024-10-08 14:28:59,367] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:28:55.444300+00:00 [running]> on host a4db7faca92e
[2024-10-08 14:28:59,411] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T14:28:55.444300+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T14:28:55.444300+00:00
[2024-10-08 14:28:59,412] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 14:28:59,412] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 14:28:59,416] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 14:29:00,027] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 14:29:00,038] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T142855, start_date=20241008T142859, end_date=20241008T142900
[2024-10-08 14:29:00,063] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 14:29:00,116] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 14:29:13,705] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:29:12.748029+00:00 [queued]>
[2024-10-08 14:29:13,729] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:29:12.748029+00:00 [queued]>
[2024-10-08 14:29:13,729] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:29:13,729] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 14:29:13,729] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:29:13,741] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 14:29:12.748029+00:00
[2024-10-08 14:29:13,743] {standard_task_runner.py:52} INFO - Started process 285 to run task
[2024-10-08 14:29:13,746] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T14:29:12.748029+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmpn5b5pjj5', '--error-file', '/tmp/tmpp28riteb']
[2024-10-08 14:29:13,749] {standard_task_runner.py:77} INFO - Job 4: Subtask extract_user_purchase_data
[2024-10-08 14:29:13,786] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:29:12.748029+00:00 [running]> on host a4db7faca92e
[2024-10-08 14:29:13,830] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T14:29:12.748029+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T14:29:12.748029+00:00
[2024-10-08 14:29:13,831] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 14:29:13,832] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 14:29:13,835] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 14:29:14,509] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 14:29:14,521] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T142912, start_date=20241008T142913, end_date=20241008T142914
[2024-10-08 14:29:14,561] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 14:29:14,600] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 14:29:22,703] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:29:21.441284+00:00 [queued]>
[2024-10-08 14:29:22,730] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:29:21.441284+00:00 [queued]>
[2024-10-08 14:29:22,730] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:29:22,731] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 14:29:22,731] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 14:29:22,744] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 14:29:21.441284+00:00
[2024-10-08 14:29:22,747] {standard_task_runner.py:52} INFO - Started process 298 to run task
[2024-10-08 14:29:22,750] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T14:29:21.441284+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmp6cpg0zhg', '--error-file', '/tmp/tmpaqw5w2my']
[2024-10-08 14:29:22,753] {standard_task_runner.py:77} INFO - Job 5: Subtask extract_user_purchase_data
[2024-10-08 14:29:22,794] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T14:29:21.441284+00:00 [running]> on host a4db7faca92e
[2024-10-08 14:29:22,842] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T14:29:21.441284+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T14:29:21.441284+00:00
[2024-10-08 14:29:22,843] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 14:29:22,843] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 14:29:22,847] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 14:29:23,631] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 14:29:23,641] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T142921, start_date=20241008T142922, end_date=20241008T142923
[2024-10-08 14:29:23,685] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 14:29:23,744] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 15:15:06,616] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 15:15:06,636] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 15:15:06,636] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 15:15:06,636] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 15:15:06,636] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 15:15:06,647] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-07 00:00:00+00:00
[2024-10-08 15:15:06,650] {standard_task_runner.py:52} INFO - Started process 820 to run task
[2024-10-08 15:15:06,653] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'scheduled__2024-10-07T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmpq3rsr7b4', '--error-file', '/tmp/tmp6lyc56gp']
[2024-10-08 15:15:06,656] {standard_task_runner.py:77} INFO - Job 3: Subtask extract_user_purchase_data
[2024-10-08 15:15:06,694] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [running]> on host 9192cc881e56
[2024-10-08 15:15:06,742] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-07T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-07T00:00:00+00:00
[2024-10-08 15:15:06,742] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 15:15:06,743] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 15:15:06,747] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 15:15:07,538] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 15:15:07,549] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241007T000000, start_date=20241008T151506, end_date=20241008T151507
[2024-10-08 15:15:07,587] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 15:15:07,621] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 15:15:09,374] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T15:15:05.735151+00:00 [queued]>
[2024-10-08 15:15:09,397] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T15:15:05.735151+00:00 [queued]>
[2024-10-08 15:15:09,397] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 15:15:09,397] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 15:15:09,397] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 15:15:09,407] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 15:15:05.735151+00:00
[2024-10-08 15:15:09,410] {standard_task_runner.py:52} INFO - Started process 823 to run task
[2024-10-08 15:15:09,413] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T15:15:05.735151+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmp9gpo2lg9', '--error-file', '/tmp/tmpu6bc1d3o']
[2024-10-08 15:15:09,416] {standard_task_runner.py:77} INFO - Job 4: Subtask extract_user_purchase_data
[2024-10-08 15:15:09,452] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T15:15:05.735151+00:00 [running]> on host 9192cc881e56
[2024-10-08 15:15:09,497] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T15:15:05.735151+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T15:15:05.735151+00:00
[2024-10-08 15:15:09,498] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 15:15:09,498] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 15:15:09,502] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 15:15:10,120] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 15:15:10,130] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T151505, start_date=20241008T151509, end_date=20241008T151510
[2024-10-08 15:15:10,187] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 15:15:10,223] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 15:15:20,588] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T15:15:19.502175+00:00 [queued]>
[2024-10-08 15:15:20,610] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T15:15:19.502175+00:00 [queued]>
[2024-10-08 15:15:20,610] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 15:15:20,610] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 15:15:20,610] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 15:15:20,620] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 15:15:19.502175+00:00
[2024-10-08 15:15:20,623] {standard_task_runner.py:52} INFO - Started process 835 to run task
[2024-10-08 15:15:20,626] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T15:15:19.502175+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmpu21tblzq', '--error-file', '/tmp/tmppnh6po0h']
[2024-10-08 15:15:20,629] {standard_task_runner.py:77} INFO - Job 5: Subtask extract_user_purchase_data
[2024-10-08 15:15:20,664] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T15:15:19.502175+00:00 [running]> on host 9192cc881e56
[2024-10-08 15:15:20,708] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T15:15:19.502175+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T15:15:19.502175+00:00
[2024-10-08 15:15:20,710] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 15:15:20,710] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 15:15:20,714] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 15:15:21,461] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 15:15:21,481] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T151519, start_date=20241008T151520, end_date=20241008T151521
[2024-10-08 15:15:21,520] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 15:15:21,558] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 17:06:27,534] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 17:06:27,554] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 17:06:27,554] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:06:27,554] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 17:06:27,554] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:06:27,565] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-07 00:00:00+00:00
[2024-10-08 17:06:27,568] {standard_task_runner.py:52} INFO - Started process 219 to run task
[2024-10-08 17:06:27,571] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'scheduled__2024-10-07T00:00:00+00:00', '--job-id', '3', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmpeg77u108', '--error-file', '/tmp/tmputh59e2v']
[2024-10-08 17:06:27,574] {standard_task_runner.py:77} INFO - Job 3: Subtask extract_user_purchase_data
[2024-10-08 17:06:27,614] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [running]> on host 2f9dc38b94bc
[2024-10-08 17:06:27,665] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-07T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-07T00:00:00+00:00
[2024-10-08 17:06:27,665] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 17:06:27,666] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 17:06:27,669] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 17:06:28,365] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 17:06:28,376] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241007T000000, start_date=20241008T170627, end_date=20241008T170628
[2024-10-08 17:06:28,425] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 17:06:28,458] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 17:06:30,639] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:06:26.851236+00:00 [queued]>
[2024-10-08 17:06:30,667] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:06:26.851236+00:00 [queued]>
[2024-10-08 17:06:30,667] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:06:30,667] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 17:06:30,667] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:06:30,678] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 17:06:26.851236+00:00
[2024-10-08 17:06:30,681] {standard_task_runner.py:52} INFO - Started process 221 to run task
[2024-10-08 17:06:30,684] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T17:06:26.851236+00:00', '--job-id', '4', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmpfzh1zj0p', '--error-file', '/tmp/tmpbqc6nzhc']
[2024-10-08 17:06:30,687] {standard_task_runner.py:77} INFO - Job 4: Subtask extract_user_purchase_data
[2024-10-08 17:06:30,725] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:06:26.851236+00:00 [running]> on host 2f9dc38b94bc
[2024-10-08 17:06:30,772] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T17:06:26.851236+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T17:06:26.851236+00:00
[2024-10-08 17:06:30,773] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 17:06:30,774] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 17:06:30,778] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 17:06:31,441] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 17:06:31,451] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T170626, start_date=20241008T170630, end_date=20241008T170631
[2024-10-08 17:06:31,499] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 17:06:31,559] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 17:06:39,591] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:06:38.895210+00:00 [queued]>
[2024-10-08 17:06:39,616] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:06:38.895210+00:00 [queued]>
[2024-10-08 17:06:39,617] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:06:39,617] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 17:06:39,617] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:06:39,628] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 17:06:38.895210+00:00
[2024-10-08 17:06:39,631] {standard_task_runner.py:52} INFO - Started process 233 to run task
[2024-10-08 17:06:39,633] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T17:06:38.895210+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmp598sli7y', '--error-file', '/tmp/tmpdn7o4x1p']
[2024-10-08 17:06:39,637] {standard_task_runner.py:77} INFO - Job 5: Subtask extract_user_purchase_data
[2024-10-08 17:06:39,676] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:06:38.895210+00:00 [running]> on host 2f9dc38b94bc
[2024-10-08 17:06:39,721] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T17:06:38.895210+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T17:06:38.895210+00:00
[2024-10-08 17:06:39,722] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 17:06:39,722] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 17:06:39,726] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 17:06:40,519] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 17:06:40,531] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T170638, start_date=20241008T170639, end_date=20241008T170640
[2024-10-08 17:06:40,569] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 17:06:40,637] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 17:12:29,728] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:12:28.445608+00:00 [queued]>
[2024-10-08 17:12:29,752] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:12:28.445608+00:00 [queued]>
[2024-10-08 17:12:29,752] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:12:29,752] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 17:12:29,752] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 17:12:29,763] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-08 17:12:28.445608+00:00
[2024-10-08 17:12:29,766] {standard_task_runner.py:52} INFO - Started process 565 to run task
[2024-10-08 17:12:29,768] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'manual__2024-10-08T17:12:28.445608+00:00', '--job-id', '6', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmpre71rw2z', '--error-file', '/tmp/tmpaoy1f9ty']
[2024-10-08 17:12:29,771] {standard_task_runner.py:77} INFO - Job 6: Subtask extract_user_purchase_data
[2024-10-08 17:12:29,810] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data manual__2024-10-08T17:12:28.445608+00:00 [running]> on host 2f9dc38b94bc
[2024-10-08 17:12:29,861] {taskinstance.py:1414} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-08T17:12:28.445608+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-10-08T17:12:28.445608+00:00
[2024-10-08 17:12:29,862] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 17:12:29,862] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 17:12:29,866] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 17:12:30,615] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 17:12:30,625] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241008T171228, start_date=20241008T171229, end_date=20241008T171230
[2024-10-08 17:12:30,663] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 17:12:30,722] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-10-08 18:14:10,335] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 18:14:10,347] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [queued]>
[2024-10-08 18:14:10,347] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 18:14:10,347] {taskinstance.py:1242} INFO - Starting attempt 1 of 3
[2024-10-08 18:14:10,347] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2024-10-08 18:14:10,357] {taskinstance.py:1262} INFO - Executing <Task(PostgresOperator): extract_user_purchase_data> on 2024-10-07 00:00:00+00:00
[2024-10-08 18:14:10,360] {standard_task_runner.py:52} INFO - Started process 213 to run task
[2024-10-08 18:14:10,363] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'user_behaviour', 'extract_user_purchase_data', 'scheduled__2024-10-07T00:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/user_behaviour.py', '--cfg-path', '/tmp/tmp8c1___8o', '--error-file', '/tmp/tmpaawz2_7c']
[2024-10-08 18:14:10,366] {standard_task_runner.py:77} INFO - Job 2: Subtask extract_user_purchase_data
[2024-10-08 18:14:10,406] {logging_mixin.py:109} INFO - Running <TaskInstance: user_behaviour.extract_user_purchase_data scheduled__2024-10-07T00:00:00+00:00 [running]> on host 3a41dbf1a504
[2024-10-08 18:14:10,461] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@***.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=user_behaviour
AIRFLOW_CTX_TASK_ID=extract_user_purchase_data
AIRFLOW_CTX_EXECUTION_DATE=2024-10-07T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-10-07T00:00:00+00:00
[2024-10-08 18:14:10,462] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2024-10-08 18:14:10,462] {base.py:79} INFO - Using connection to: id: postgres_default. Host: postgres, Port: 5432, Schema: ***, Login: ***, Password: ***, extra: {}
[2024-10-08 18:14:10,466] {dbapi.py:225} INFO - Running statement: COPY (
       select invoice_number,
              stock_code,
              detail,
              quantity,
              invoice_date,
              unit_price,
              customer_id,
              country
       from retail.user_purchase -- we should have a date filter here to pull only required data
) TO '/temp/user_purchase.csv' WITH (FORMAT CSV, HEADER);, parameters: None
[2024-10-08 18:14:11,148] {dbapi.py:233} INFO - Rows affected: 541908
[2024-10-08 18:14:11,158] {taskinstance.py:1280} INFO - Marking task as SUCCESS. dag_id=user_behaviour, task_id=extract_user_purchase_data, execution_date=20241007T000000, start_date=20241008T181410, end_date=20241008T181411
[2024-10-08 18:14:11,217] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-10-08 18:14:11,255] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
